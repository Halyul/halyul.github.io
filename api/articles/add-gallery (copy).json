{"title":"为Hexo的Material主题添加总图库以及分图库功能","slug":"add-gallery (copy)","date":"2016-12-30T09:33:13.000Z","updated":"2016-12-30T12:11:34.000Z","comments":true,"path":"api/articles/add-gallery (copy).json","excerpt":"嗯现在博客换了主题这个用不上了惹。<br>","covers":null,"content":"<p>嗯现在博客换了主题这个用不上了惹。<br><a id=\"more\"></a></p>\n<h2 id=\"起因\"><a href=\"#起因\" class=\"headerlink\" title=\"起因\"></a>起因</h2><p>今天将整个[Material主题][1]研究了一遍，发现了这个主题自带图库，然而这个图库只能支持一个相册，想将相册分类是不可能的，故而稍加研究，自己添加了这个功能。</p>\n<p>总图库由友情链接页面修改得来，子图库则为原图库页面。<br>[1]: <a href=\"https://material.vss.im/\" target=\"_blank\" rel=\"noopener\">https://material.vss.im/</a> “Material主题”</p>\n<h2 id=\"经过\"><a href=\"#经过\" class=\"headerlink\" title=\"经过\"></a>经过</h2><h3 id=\"添加总图库\"><a href=\"#添加总图库\" class=\"headerlink\" title=\"添加总图库\"></a>添加总图库</h3><h4 id=\"加入总图库入口\"><a href=\"#加入总图库入口\" class=\"headerlink\" title=\"加入总图库入口\"></a>加入总图库入口</h4><p>在主题文件夹下的<code>_config.yml</code>找到<code>pages</code>项，插入一行：<code>图库: &quot;/galleries/&quot;</code></p>\n<blockquote>\n<p>其中<code>图库</code>、<code>galleries</code>可修改。</p>\n</blockquote>\n<p>然后，在博客主目录的<code>source</code>文件夹中新建一个同名文件夹。</p>\n<blockquote>\n<p>例如我的文件夹名称为galleries。</p>\n</blockquote>\n<p>并新建一个<code>index.md</code>文件，加入以下代码：</p>\n<pre class=\"line-numbers language-markdown\" mdui-tooltip=\"{content: 'markdown'}\"><code class=\"language-markdown\"><span class=\"token hr punctuation\">---</span>\ntitle: 图库\ndate: 2016/12/30\n<span class=\"token title important\">layout: galleries\n<span class=\"token punctuation\">---</span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p><code>title</code> 为网页标题，<code>图库</code>可修改，<code>galleries</code>可修改，但必须与上面的一致。</p>\n</blockquote>\n<p>再新建一个<code>_data</code>文件夹（不可改名）</p>\n<h4 id=\"添加代码\"><a href=\"#添加代码\" class=\"headerlink\" title=\"添加代码\"></a>添加代码</h4><p>进入主题文件夹的<code>layout</code>文件夹中，打开<code>post.ejs</code>文件，找一个自己喜欢的位置，添加下面的代码。</p>\n<pre class=\"line-numbers language-ejs\" mdui-tooltip=\"{content: 'ejs'}\"><code class=\"language-ejs\"><!-- Galleries start -->\n<% } else if(page.layout == \"galleries\") { %>\n<%- partial(\"_widget/page-galleries\") %>\n<!-- Galleries end -->\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p>其中第二行中<code>galleries</code>以及第三行的<code>page-galleries</code>可以修改。</p>\n</blockquote>\n<p>然后在<code>_widget</code>文件夹中复制<code>page-links.ejs</code>文件一份，重命名为<code>page-galleries.ejs</code>，打开并找到第83、84、86、87、89行的<br><code>site.data.links</code>，替换为<code>site.data.galleries</code><br>，以及第87行<code>avatar</code>替换为<code>pic</code>。</p>\n<blockquote>\n<p><code>galleries</code>和<code>pic</code>可修改。</p>\n</blockquote>\n<h3 id=\"添加子图库\"><a href=\"#添加子图库\" class=\"headerlink\" title=\"添加子图库\"></a>添加子图库</h3><h4 id=\"加入子图库入口1\"><a href=\"#加入子图库入口1\" class=\"headerlink\" title=\"加入子图库入口1\"></a>加入子图库入口1</h4><p>进入博客主目录的<code>source/_data</code>文件夹中，新建一个<code>galleries.yml</code>文件，加入以下代码</p>\n<pre class=\"line-numbers language-yaml\" mdui-tooltip=\"{content: 'yaml'}\"><code class=\"language-yaml\"><span class=\"token key atrule\">Name</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">link</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//example.com/gallery1\n    <span class=\"token key atrule\">pic</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//example.com/pic.png\n    <span class=\"token key atrule\">descr</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"这是一个描述\"</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p><code>Name</code>修改为你的子图库名称，<code>gallery1</code>为你的子图库名称（中文未测试，这个名称后面会用到），<code>pic</code>为缩略图。</p>\n</blockquote>\n<h4 id=\"添加代码-1\"><a href=\"#添加代码-1\" class=\"headerlink\" title=\"添加代码\"></a>添加代码</h4><p>进入主题文件夹的<code>layout</code>文件夹中，打开<code>layout.ejs</code>文件，在</p>\n<pre class=\"line-numbers language-ejs\" mdui-tooltip=\"{content: 'ejs'}\"><code class=\"language-ejs\"><% } else { %>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>前添加以下代码</p>\n<pre class=\"line-numbers language-ejs\" mdui-tooltip=\"{content: 'ejs'}\"><code class=\"language-ejs\"><!-- gallery1 start-->\n<% } else if(page.layout == \"gallery1\") { %>\n<%- partial(\"_widget/page-gallery1\") %>\n<!-- gallery1 end-->\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>进入<code>_widget</code>文件夹中复制<code>page-gallery.ejs</code>文件一份，重命名为<code>page-gallery1.ejs</code>，打开并找到第25、26、28、30行<br><code>site.data.gallery</code>，替换为<code>site.data.gallery1</code></p>\n<blockquote>\n<p><code>gallery1</code>均可修改，但必须与上面的一致。</p>\n</blockquote>\n<h4 id=\"加入子图库入口2\"><a href=\"#加入子图库入口2\" class=\"headerlink\" title=\"加入子图库入口2\"></a>加入子图库入口2</h4><p>在博客主目录的<code>source</code>文件夹中新建一个<code>gallery1</code>文件夹，并新建一个<code>index.md</code>文件，加入以下代码：</p>\n<pre class=\"line-numbers language-markdown\" mdui-tooltip=\"{content: 'markdown'}\"><code class=\"language-markdown\"><span class=\"token hr punctuation\">---</span>\ntitle: 子图库\ndate: 2016/12/30\n<span class=\"token title important\">layout: gallery1\n<span class=\"token punctuation\">---</span></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p><code>title</code> 为网页标题及页面左下角标题，<code>子图库</code>可修改，<code>galleries</code>可修改，但必须与上面的一致。</p>\n</blockquote>\n<p>进入<code>_data</code>文件夹，新建一个<code>gallery1.yml</code>文件，加入以下代码：</p>\n<pre class=\"line-numbers language-yaml\" mdui-tooltip=\"{content: 'yaml'}\"><code class=\"language-yaml\"><span class=\"token key atrule\">Name</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">full_link</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//example.com/pic1.png\n    <span class=\"token key atrule\">thumb_link</span><span class=\"token punctuation\">:</span> http<span class=\"token punctuation\">:</span>//example.com/pic1<span class=\"token punctuation\">-</span>thumb.png\n    <span class=\"token key atrule\">descr</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"这是一个描述\"</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<blockquote>\n<p><code>Name</code>修改为你的一张照片名称，<code>full_link</code>为你的照片的连接，<code>thumb_link</code>为该照片的缩略图。添加多张图片，只需要根据上面的格式重复填写即可。</p>\n</blockquote>\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><p>到这里完成了，自己去看看效果吧！<br>我的效果如下：</p>\n<p>![总图库效果][2]</p>\n<p>![子图库效果][3]<br>[2]: <a href=\"https://img.halyul.com/images/2017/03/15/o_1b7vimbuo745scekls1vj81b8ba.png\" target=\"_blank\" rel=\"noopener\">https://img.halyul.com/images/2017/03/15/o_1b7vimbuo745scekls1vj81b8ba.png</a><br>[3]: <a href=\"https://img.halyul.com/images/2017/03/15/o_1b7vimqhl7oj112vsjg5pn7vfa.png\" target=\"_blank\" rel=\"noopener\">https://img.halyul.com/images/2017/03/15/o_1b7vimqhl7oj112vsjg5pn7vfa.png</a></p>\n","categories":[],"tags":[]}